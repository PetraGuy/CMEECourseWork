data
?geom_col
ggplot(data, aes(x = DBH_class, y = Count), stat = "count")+
geom_col()+
scale_x_continuous(breaks = 1:20,
limits = c(0,20),
labels = c(1:20))
ggplot(data, aes(x = DBH_class, y = Count), stat = "count")+
geom_bar()+
scale_x_continuous(breaks = 1:20,
limits = c(0,20),
labels = c(1:20))
ggplot(data, aes(x = DBH_class), stat = "count")+
geom_bar()+
scale_x_continuous(breaks = 1:20,
limits = c(0,20),
labels = c(1:20))
ggplot(data, aes(x = DBH_class), stat = "Count")+
geom_bar()+
scale_x_continuous(breaks = 1:20,
limits = c(0,20),
labels = c(1:20))
data
ggplot(data, aes(DBH_class))
geom_bar()
PlotPlot(78,12)
PlotPlt(78,14)
PlotPlot(78,14)
PlotSite(78)
PlotPlt(83,3)
PlotPlot(83,2)
PlotPlot(83,3)
PlotPlot(78,2)
PlotPlot = function(i,j){
data = DBH_Yr2_agg %>% filter(SITE == i)%>%filter(PLOT==j)
t1 = paste("site",i)
t2 = paste("plot",j)
Title = paste(t1,t2, sep = " ")
Plot = ggplot(data = data, aes(x = DBH_class, y = Count)) +
geom_bar(stat = "count", col = "black", fill = "green") +
scale_x_continuous("DBH class",
breaks = 1:20,
labels = c(1:20),
limits = c(0, 20))+
labs(title = Title)#+ount
#theme(axis.ticks = element_blank(), axis.text.x = element_blank())
#print(Plot)
return(Plot)
}
PlotPlot(78,2)
PlotPlot = function(i,j){
data = DBH_Yr2_agg %>% filter(SITE == i)%>%filter(PLOT==j)
t1 = paste("site",i)
t2 = paste("plot",j)
Title = paste(t1,t2, sep = " ")
Plot = ggplot(data = data, aes(x = DBH_class)) +
geom_bar(stat = "count", col = "black", fill = "green") +
scale_x_continuous("DBH class",
breaks = 1:20,
labels = c(1:20),
limits = c(0, 20))+
labs(title = Title)#+ount
#theme(axis.ticks = element_blank(), axis.text.x = element_blank())
#print(Plot)
return(Plot)
}
PlotPlot(78,2)
PlotPlot = function(i,j){
data = DBH_Yr2_agg %>% filter(SITE == i)%>%filter(PLOT==j)
t1 = paste("site",i)
t2 = paste("plot",j)
Title = paste(t1,t2, sep = " ")
Plot = ggplot(data = data, aes(x = DBH_class, weight = "Count")) +
geom_bar(stat = "indentity", col = "black", fill = "green") +
scale_x_continuous("DBH class",
breaks = 1:20,
labels = c(1:20),
limits = c(0, 20))+
labs(title = Title)#+ount
#theme(axis.ticks = element_blank(), axis.text.x = element_blank())
#print(Plot)
return(Plot)
}
PlotPlot(78,2)
?geom_bar
PlotPlot = function(i,j){
data = DBH_Yr2_agg %>% filter(SITE == i)%>%filter(PLOT==j)
t1 = paste("site",i)
t2 = paste("plot",j)
Title = paste(t1,t2, sep = " ")
Plot = ggplot(data = data, aes(x = DBH_class, weight = "Count")) +
geom_bar(stat = "indentity", col = "black", fill = "green") +
scale_x_continuous("DBH class",
breaks = 1:20,
labels = c(1:20),
limits = c(0, 20))+
labs(title = Title)#+ount
#theme(axis.ticks = element_blank(), axis.text.x = element_blank())
#print(Plot)
return(Plot)
}
PlotPlot(78,2)
PlotPlot = function(i,j){
data = DBH_Yr2_agg %>% filter(SITE == i)%>%filter(PLOT==j)
t1 = paste("site",i)
t2 = paste("plot",j)
Title = paste(t1,t2, sep = " ")
Plot = ggplot(data = data, aes(x = DBH_class, weight = "Count")) +
geom_bar(stat = "count", col = "black", fill = "green") +
scale_x_continuous("DBH class",
breaks = 1:20,
labels = c(1:20),
limits = c(0, 20))+
labs(title = Title)#+ount
#theme(axis.ticks = element_blank(), axis.text.x = element_blank())
#print(Plot)
return(Plot)
}
PlotPlot(78,2)
PlotPlot = function(i,j){
data = DBH_Yr2_agg %>% filter(SITE == i)%>%filter(PLOT==j)
t1 = paste("site",i)
t2 = paste("plot",j)
Title = paste(t1,t2, sep = " ")
Plot = ggplot(data = data, aes(x = DBH_class, weight = "Count")) +
geom_bar(col = "black", fill = "green") +
scale_x_continuous("DBH class",
breaks = 1:20,
labels = c(1:20),
limits = c(0, 20))+
labs(title = Title)#+ount
#theme(axis.ticks = element_blank(), axis.text.x = element_blank())
#print(Plot)
return(Plot)
}
PlotPlot(78,2)
PlotPlot = function(i,j){
data = DBH_Yr2_agg %>% filter(SITE == i)%>%filter(PLOT==j)
t1 = paste("site",i)
t2 = paste("plot",j)
Title = paste(t1,t2, sep = " ")
Plot = ggplot(data = data, aes(x = DBH_class)) +
geom_bar(col = "black", fill = "green") +
scale_x_continuous("DBH class",
breaks = 1:20,
labels = c(1:20),
limits = c(0, 20))+
labs(title = Title)#+ount
#theme(axis.ticks = element_blank(), axis.text.x = element_blank())
#print(Plot)
return(Plot)
}
PlotPlot(78,2)
PlotPlot = function(i,j){
data = DBH_Yr2_agg %>% filter(SITE == i)%>%filter(PLOT==j)
t1 = paste("site",i)
t2 = paste("plot",j)
Title = paste(t1,t2, sep = " ")
Plot = ggplot(data = data, aes(x = DBH_class, y = "Count")) +
geom_bar(stat = "identity", col = "black", fill = "green") +
scale_x_continuous("DBH class",
breaks = 1:20,
labels = c(1:20),
limits = c(0, 20))+
labs(title = Title)#+ount
#theme(axis.ticks = element_blank(), axis.text.x = element_blank())
#print(Plot)
return(Plot)
}
PlotPlot(78,2)
PlotPlot = function(i,j){
data = DBH_Yr2_agg %>% filter(SITE == i)%>%filter(PLOT==j)
t1 = paste("site",i)
t2 = paste("plot",j)
Title = paste(t1,t2, sep = " ")
Plot = ggplot(data = data, aes(x = DBH_class, y = Count)) +
geom_bar(stat = "identity", col = "black", fill = "green") +
scale_x_continuous("DBH class",
breaks = 1:20,
labels = c(1:20),
limits = c(0, 20))+
labs(title = Title)#+ount
#theme(axis.ticks = element_blank(), axis.text.x = element_blank())
#print(Plot)
return(Plot)
}
PlotPlot(78,2)
PlotPlot = function(i,j){
data = DBH_Yr2_agg %>% filter(SITE == i)%>%filter(PLOT==j)
t1 = paste("site",i)
t2 = paste("plot",j)
Title = paste(t1,t2, sep = " ")
Plot = ggplot(data = data, aes(x = DBH_class, y = Count)) +
geom_bar(stat = "identity", col = "black", fill = "green", width = 1) +
scale_x_continuous("DBH class",
breaks = 1:20,
labels = c(1:20),
limits = c(0, 20))+
labs(title = Title)#+ount
#theme(axis.ticks = element_blank(), axis.text.x = element_blank())
#print(Plot)
return(Plot)
}
PlotPlot(78,2)
#to generate plot of a site
PlotSite = function(i){
Site = DBH_Yr2_agg %>% filter(SITE == i)
Plotname = paste("Site", i, sep = "")
Plot = ggplot(data = Site, aes(x = DBH_class, y = Count)) +
geom_bar(stat = "identity", col = "black", fill = "green") +
scale_x_continuous("DBH class",
breaks = 1:20,
labels = c(1:20),
limits = c(0, 20))+
facet_wrap(~PLOT)
labs(title = Plotname)#+
#theme(axis.ticks = element_blank(), axis.text.x = element_blank())
print(Plot)
}
#to generate plot of a plot
PlotPlot = function(i,j){
data = DBH_Yr2_agg %>% filter(SITE == i)%>%filter(PLOT==j)
t1 = paste("site",i)
t2 = paste("plot",j)
Title = paste(t1,t2, sep = " ")
Plot = ggplot(data = data, aes(x = DBH_class, y = Count)) +
geom_bar(stat = "indentity", col = "black", fill = "green", width = 1) +
scale_x_continuous("DBH class",
breaks = 1:20,
labels = c(1:20),
limits = c(0, 20))+
labs(title = Title)#+ount
#theme(axis.ticks = element_blank(), axis.text.x = element_blank())
#print(Plot)
return(Plot)
}
# To get DBH data for a plot
DBH = function(i,j){
DBH_Yr2_agg%>%filter(SITE == i)%>% filter(PLOT == j)
}
#display index for a plot
In = function(i,j){
indices%>%filter(SITE == i)%>%filter(PLOT == j)
}
PlotPlot(78,2)
PlotPlot = function(i,j){
data = DBH_Yr2_agg %>% filter(SITE == i)%>%filter(PLOT==j)
t1 = paste("site",i)
t2 = paste("plot",j)
Title = paste(t1,t2, sep = " ")
Plot = ggplot(data = data, aes(x = DBH_class, y = Count)) +
geom_bar(stat = "identity", col = "black", fill = "green", width = 1) +
scale_x_continuous("DBH class",
breaks = 1:20,
labels = c(1:20),
limits = c(0, 20))+
labs(title = Title)#+ount
#theme(axis.ticks = element_blank(), axis.text.x = element_blank())
#print(Plot)
return(Plot)
}
PlotPlot(78,2)
PlotPlot = function(i,j){
data = DBH_Yr2_agg %>% filter(SITE == i)%>%filter(PLOT==j)
t1 = paste("site",i)
t2 = paste("plot",j)
Title = paste(t1,t2, sep = " ")
Plot = ggplot(data = data, aes(x = DBH_class, y = Count)) +
geom_bar(stat = "identity", col = "black", fill = "green", width = 1) +
scale_x_continuous("DBH class",
breaks = 1:20,
labels = c(1:20),
limits = c(0, 20))+
labs(title = Title)#+ount
#theme(axis.ticks = element_blank(), axis.text.x = element_blank())
#print(Plot)
return(Plot)
}
PlotPlot(78,2)
png("../Data/Talk/72_2dbh")
PlotPlot(78,2)
dev.off()
png("../Data/Talk/72_12dbh")
PlotPlot(78,12)
dev.off()
png("../Data/Talk/72_12dbh")
PlotPlot(78,14)
dev.off()
png("../Data/Talk/72_14dbh")
PlotPlot(78,14)
dev.off()
png("../Data/Talk/83_3dbh")
PlotPlot(83,3)
dev.off()
PlotPlot(78,12)
PlotPlot(78,2
)
##fit every wood and look at coefficients
#prepare data
plots = c("plot1","plot2","plot3","plot4","plot5","plot6","plot7",
"plot8","plot9","plot10","plot11","plot12","plot13","plot14","plot15","plot16")
area = c("4","25","50","100","200")
areas = sort(as.numeric(rep(area,16)), decreasing = FALSE)
fits_all_woods = function(){
coef_df = data.frame(matrix(ncol = 2, nrow = 0))
#prepare data
for (i in 1:103){
#browser()
cf_site = cum_rich_all[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf$area = areas
# zeros will freak this model out, make them NAs
melted_cf[melted_cf==0]=NA
#model
model_nlme_area_log = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
#get coefficients
int = model_nlme_area_log$coefficients$fixed[[1]]
slope = model_nlme_area_log$coefficients$fixed[[2]]
row = c(int,slope)
coef_df = rbind(coef_df,row)
}
colnames(coef_df) = c("intercept","slope")
return(coef_df)
}
fits = fits_all_woods()
#max and min slope
maxvars = fits[which(fits$slope == max(fits$slope)),]
minvars = fits[which(fits$slope == min(fits$slope)),]
ggplot()+
geom_abline(data = fits,aes(intercept = intercept, slope = slope), colour = "pink")+
geom_abline(data = maxvars,aes(intercept = intercept, slope = slope), colour = "red" )+
geom_abline(data = minvars,aes(intercept = intercept, slope = slope), colour = "blue" )+
scale_x_continuous(limits = c(0,5))+
scale_y_continuous(limits = c(0,4))+
ggtitle("ln/ln fits for all woodlands")+
annotate("text", x = 3, y = 0.5,
label = "maximum slope 0.43, minumum slope = 0.098")+
labs(x = "ln(area)", y = "ln(richness)")
ggplot()+
geom_abline(data = fits,aes(intercept = intercept, slope = slope), colour = "pink")+
geom_abline(data = maxvars,aes(intercept = intercept, slope = slope), colour = "red" )+
geom_abline(data = minvars,aes(intercept = intercept, slope = slope), colour = "blue" )+
scale_x_continuous(limits = c(0,5))+
scale_y_continuous(limits = c(0,4))+
ggtitle("ln/ln fits for all woodlands")+
annotate("text", x = 3, y = 0.5,
label = "maximum slope 0.43, minumum slope = 0.098")+
labs(x = "ln(area)", y = "ln(richness)")
fits
hist(fits$slope)
hist(fits$intercept)
ggplot(fits, aes(Slope))+
geom_histogram()
ggplot(fits, aes(slope))+
geom_histogram()
ggplot(fits, aes(slope))+
geom_histogram(binwidth = 0.1)
ggplot(fits, aes(slope))+
geom_histogram(binwidth = 0.05)
ggplot(fits, aes(slope))+
geom_histogram(binwidth = 0.05, col = "black", fill = "grey")
ggplot(fits, aes(slope))+
geom_histogram(binwidth = 0.05, col = "black", fill = "grey")+
ggtitle("distribution of slopes in linear mixed effect ln/ln fit")
ggplot(fits, aes(slope))+
geom_histogram(binwidth = 0.05, col = "black", fill = "grey")+
ggtitle("Distribution of slopes in linear mixed effect ln/ln fit", subtitle = "S = cA^0.25 ish")
png("../Data/Talk/slopes_hist")
ggplot(fits, aes(slope))+
geom_histogram(binwidth = 0.05, col = "black", fill = "grey")+
ggtitle("Distribution of slopes in linear mixed effect ln/ln fit", subtitle = "S = cA^0.25 ish")
dev.off()
sitedata = read.csv("../Data/AnalysisEnvDataLevelSite.csv")
setwd("~/Documents/CMEECourseWork/CMEEMainProject/Code")
sitedata = read.csv("../Data/AnalysisEnvDataLevelSite.csv")
sitedata = read.csv("../Data/AnalysisEnvDatAnalyaLevelSite.csv")
sitedata = read.csv("../Data/AnalysisEnvDataLevelSite.csv")
sitedata = read.csv("../Data/AnalysisEnvdataLevelSite.csv")
View(sitedata)
View(plotdata)
View(plotdata)
ancientwoods = sitedata%>%filter(AW==1|PAW==1)
ancientwoods = sitedata%>%filter(AW==1|PAWS==1)
ancientwoods
length(ancientwoods)
d
medianrichness
##what is median richness?
medianrichness = median(d)
medianrichness
#select woods with above median richness
above_median = wood_rich%>%filter(d>73)
ancientwoods$Site
above_median$Site
length(ancientwoods)
View(ancientwoods)
View(ancientwoods)
intersect(ancientwoods$Site,above_median$Site)
length(intersect(ancientwoods$Site,above_median$Site))
View(DBH_Yr2_agg)
View(DBH_Yr2_agg)
dbhmeans = read.csv("../Data/dbh_means.csv")
View(dbhmeans)
site83mean = dbhmeans[83,]
site83mean
View(spec_rich)
View(spec_rich)
View(plot_rich)
View(plot_rich)
site83richness = plot_rich[83,]
site83richness
site83mean
plot(site83mean,site83richness)
site83mean[83,]
site83mean[1,
]
tmp = cbind(site83mean,site83richness)
tmp
site83richness
site83mean
as.vector(site83mean)
as.data.frame(cbind(site83mean,site83richness))
as.data.frame(rbind(site83mean,site83richness))
View(dbhmeans)
site83mean = as.vector(dbhmeans[83,])
site83mean
dnhmeans = dbhmeans[-1]
dbhmeans = dbhmeans[-1]
site83mean = dbhmeans[83,]
site83mean
tmp = cbind(site83mean,site83richness)
tmp
tmp = rbind(site83mean, site83richness)
tmp
t(tmp)
tmp
tmp = t(tmp)
colnames(tmp) = c("dbhmean","richness")
tmp
plot(tmp)
species83_15 = species_per_plot%>%filter(Site==83)%>%filter(Plot==15)
species83_15
dbhmeans = dbhmeans[-1]
dbhmeans = dbhmeans[-1]
site83mean = dbhmeans[83,]
site83richness = plot_rich[83,]
tmp = rbind(site83mean, site83richness)
tmp = t(tmp)
colnames(tmp) = c("dbhmean","richness")
tmp
ggplot(tmp, aes(x=dbhmean, y = richness))+
geom_point()+
ggtitle(richess with dbhmean for plots in site 83)
ggplot(tmp, aes(x=dbhmean, y = richness))+
geom_point()+
ggtitle("richess with dbhmean for plots in site 83")
typeof(tmp)
ggplot(as.data.frame(tmp), aes(x=dbhmean, y = richness))+
geom_point()+
ggtitle("richess with dbhmean for plots in site 83")
png("../Data/Talk/richnessvsmean")
ggplot(as.data.frame(tmp), aes(x=dbhmean, y = richness))+
geom_point()+
ggtitle("Richess with dbhmean for plots in site 83")
dev.off()
ggplot(as.data.frame(tmp), aes(x=dbhmean, y = richness))+
geom_point(size = 2)+
ggtitle("Richess with dbhmean for plots in site 83")
ggplot(as.data.frame(tmp), aes(x=dbhmean, y = richness))+
geom_point(size = 3)+
ggtitle("Richess with dbhmean for plots in site 83")
png("../Data/Talk/richnessvsmean")
ggplot(as.data.frame(tmp), aes(x=dbhmean, y = richness))+
geom_point(size = 3)+
ggtitle("Richess with dbhmean for plots in site 83")
dev.off()
high = wood_rich%>%filter(d>100)
high
site_mean = dbhmeans[47,]
site_richness = plot_rich[47,]
tmp = rbind(site_mean, site_richness)
tmp = t(tmp)
colnames(tmp) = c("dbhmean","richness")
ggplot(as.data.frame(tmp), aes(x=dbhmean, y = richness))+
geom_point(size = 3)+
ggtitle("Richess with dbhmean for plots in site 47")
png("../Data/Talk/richnessvsmean")
ggplot(as.data.frame(tmp), aes(x=dbhmean, y = richness))+
geom_point(size = 3)+
ggtitle("Richess with dbhmean for plots in site 47")
dev.off()
high
site_mean = dbhmeans[98,]
site_richness = plot_rich[98,]
tmp = rbind(site_mean, site_richness)
tmp = t(tmp)
colnames(tmp) = c("dbhmean","richness")
ggplot(as.data.frame(tmp), aes(x=dbhmean, y = richness))+
geom_point(size = 3)+
ggtitle("Richess with dbhmean for plots in site 98")
View(plotdata)
View(plotdata)
View(plotdata)
83 = wood_rich%>%filter(SITE == 83)
site83
site83richness
site83details = woods%>%filter(Site == 83)
site83details
site78details = woods%>%filter(Site == 78)
site78
site78details
