summary(fitall)
plot(fitall)
knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE,
out.width="60%"
)
rm(list = ls())
cat("\014")
library(dplyr)
library(visreg) # for visreg plots
library(ggplot2)
library(GGally) # for ggpairs
library(factoextra)
library(FactoMineR)# these two for PCA
library(corrplot)
library(car)
library(gridExtra)
library(reshape)
library(knitr)
library(kableExtra)
sitevars =  read.csv("../../Data/CompleteSiteLevelVars.csv")
sitevars[is.na(sitevars)]=0
#toremove = c(23,53,74)
#sitevars = sitevars%>%filter(!Site %in% toremove)
names(sitevars)[names(sitevars) =="Pos_Hetero_Index"] = "PHI"
names(sitevars)[names(sitevars) =="meantreedensity"] = "meanTD"
# after this analysis I am adding arable buffers
ArableBuffer = read.csv( "../../Data/LandCoverIndicesArable.csv")
BufferI = ArableBuffer%>%select("X","Buffer1")
colnames(BufferI) = c("Site","BufferI")
sitevars= inner_join(BufferI, sitevars)
sitevars_reduced = subset(sitevars, select = -c(X,Site,No.of.Des, Any.Anc,Buffer1,Buffer2,sd_pH,
sd_SOM,sd_LBA, sd_meandbh,sd_treedensity,
sd_R,mean_R, sd_N,mean_N , sd_W, mean_W,
sd_L, mean_L, no_trees ))
BufferI = ArableBuffer%>%select("X","Buffer1")
colnames(BufferI) = c("Site","BufferI")
sitevars= inner_join(BufferI, sitevars)
sitevars_all_lesRich = subset(sitevars_reduced, select = -c(Richness))
vars = as.vector(colnames(sitevars_reduced))
vars
# after this analysis I am adding arable buffers
model_all = lm(Richness ~., data = sitevars_reduced)
visreg(model_all)
sitevars_reduced1 = subset(sitevars, select = -c(X,Site,No.of.Des, Any.Anc,Buffer1,Buffer2,sd_pH,
sd_SOM,sd_LBA, sd_meandbh,sd_treedensity,  sd_R,mean_R,
sd_N,mean_N , sd_W, mean_W, sd_L, mean_L, meanLBA,
no_trees,  Area_ha, Perim_m ))
sitevars_all_lesRich1 = subset(sitevars_reduced1, select = -c(Richness))
vars1 = as.vector(colnames(sitevars_reduced1))
vars1
model_all1 = lm(Richness ~., data = sitevars_reduced1)
visreg(model_all1)
sitevars_reduced2 = subset(sitevars, select = -c(X,Site,No.of.Des, Any.Anc,Buffer1,Buffer2,sd_pH,
sd_SOM,sd_LBA, sd_meandbh,sd_treedensity,  sd_R,mean_R,
sd_N,mean_N , sd_W, mean_W, sd_L, mean_L, meanLBA,
no_trees,  Area_ha, Perim_m, Alt_m ))
sitevars_all_lesRich2 = subset(sitevars_reduced2, select = -c(Richness))
vars2= as.vector(colnames(sitevars_reduced2))
vars2
data = as.data.frame(cbind(sitevars$Northing,sitevars$BufferI, sitevars$Buffer3))
colnames(data)= c("Northing", "BufferI","Buffer3")
melted = melt(data, id.vars = "Northing")
g1 = ggplot(melted, aes(x= Northing, y = value))+
geom_point(aes(colour = variable))+
geom_smooth(method = lm, aes(colour = variable))
data = as.data.frame(cbind(sitevars$meandbh,sitevars$BufferI, sitevars$Buffer3))
colnames(data)= c("meandbh", "BufferI","Buffer3")
melted = melt(data, id.vars = "meandbh")
g2 = ggplot(melted, aes(x= meandbh, y = value))+
geom_point(aes(colour = variable))+
geom_smooth(method = lm, aes(colour = variable))
data = as.data.frame(cbind(sitevars$meanSOM,sitevars$BufferI, sitevars$Buffer3))
colnames(data)= c("meanSOM", "BufferI","Buffer3")
melted = melt(data, id.vars = "meanSOM")
g3 = ggplot(melted, aes(x= meanSOM, y = value))+
geom_point(aes(colour = variable))+
geom_smooth(method = lm, aes(colour = variable))
data = as.data.frame(cbind(sitevars$meanTD,sitevars$BufferI, sitevars$Buffer3))
colnames(data)= c("meanTD", "BufferI","Buffer3")
melted = melt(data, id.vars = "meanTD")
g4 = ggplot(melted, aes(x= meanTD, y = value))+
geom_point(aes(colour = variable))+
geom_smooth(method = lm, aes(colour = variable))
data = as.data.frame(cbind(sitevars$meanph,sitevars$BufferI, sitevars$Buffer3))
colnames(data)= c("meanpH", "BufferI","Buffer3")
melted = melt(data, id.vars = "meanpH")
g5 = ggplot(melted, aes(x= meanpH, y = value))+
geom_point(aes(colour = variable))+
geom_smooth(method = lm, aes(colour = variable))
data = as.data.frame(cbind(sitevars$area_ratio,sitevars$BufferI, sitevars$Buffer3))
colnames(data)= c("area_ratio", "BufferI","Buffer3")
melted = melt(data, id.vars = "area_ratio")
g6 = ggplot(melted, aes(x= area_ratio, y = value))+
geom_point(aes(colour = variable))+
geom_smooth(method = lm, aes(colour = variable))
grid.arrange(g1,g2,g3,g4,g5, g6, nrow = 3)
data = as.data.frame(cbind(sitevars$meandbh,sitevars$Northing))
colnames(data) =cbind("meandbh","Northing")
g1 = ggplot(data, aes(x= meandbh, y = Northing))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meandbh, sitevars$meanph))
colnames(data) = cbind("meandbh","meanph")
g2 = ggplot(data, aes(x= meandbh, y = meanph))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meandbh,sitevars$meanSOM))
colnames(data) =cbind("meandbh","meanSOM")
g3 = ggplot(data, aes(x= meandbh, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meanph,sitevars$meanSOM))
colnames(data) =cbind("meanph","meanSOM")
g4 = ggplot(data, aes(x= meanph, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$Northing,sitevars$meanSOM))
colnames(data) =cbind("Northing","meanSOM")
g5 = ggplot(data, aes(x= Northing, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meanTD,sitevars$meanSOM))
colnames(data) =cbind("meanTD","meanSOM")
g6 = ggplot(data, aes(x= meanTD, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meanTD,sitevars$Northing))
colnames(data) =cbind("meanTD","Northing")
g7 = ggplot(data, aes(x= meanTD, y = Northing))+
geom_point()+
geom_smooth(method = lm)
grid.arrange(g1,g2,g3,g4,g5,g6,g7, nrow =2)
data = as.data.frame(cbind(sitevars$meanTD,sitevars$Northing, sitevars$Easting))
colnames(data)= c("meanTD", "Northing","Easting")
melted = melt(data, id.vars = "meanTD")
data2 = as.data.frame(cbind(sitevars$meandbh,sitevars$Northing, sitevars$Easting))
colnames(data2)= c("meandbh", "Northing","Easting")
melted2 = melt(data2, id.vars = "meandbh")
g1 = ggplot(melted, aes(x= meanTD, y = value))+
geom_point(aes(colour = variable))+
geom_smooth(method = lm, aes(colour = variable))
g2 =  ggplot(melted2, aes(x= meandbh, y = value))+
geom_point(aes(colour = variable))+
geom_smooth(method = lm, aes(colour = variable))
g3 = ggplot(sitevars, aes(x = Northing, y = mean_L))+
geom_point()+
geom_smooth(method = lm)
g4 = ggplot(sitevars, aes(x = meanTD, y = mean_L))+
geom_point() +
geom_smooth(method = lm)
grid.arrange(g1, g2, g3,g4, nrow = 2)
data = as.data.frame(cbind(sitevars$BufferI, sitevars$Northing))
colnames(data) =cbind("BufferI","Northing")
g8 = ggplot(data, aes(x= meanTD, y = Northing))+
geom_point()+
geom_smooth(method = lm)
grid.arrange(g7,g8)
data = as.data.frame(cbind(sitevars$BufferI, sitevars$Northing))
colnames(data) =cbind("BufferI","Northing")
g8 = ggplot(data, aes(x= BufferI, y = Northing))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meandbh,sitevars$Northing))
colnames(data) =cbind("meandbh","Northing")
g1 = ggplot(data, aes(x= meandbh, y = Northing))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meandbh, sitevars$meanph))
colnames(data) = cbind("meandbh","meanph")
g2 = ggplot(data, aes(x= meandbh, y = meanph))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meandbh,sitevars$meanSOM))
colnames(data) =cbind("meandbh","meanSOM")
g3 = ggplot(data, aes(x= meandbh, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meanph,sitevars$meanSOM))
colnames(data) =cbind("meanph","meanSOM")
g4 = ggplot(data, aes(x= meanph, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$Northing,sitevars$meanSOM))
colnames(data) =cbind("Northing","meanSOM")
g5 = ggplot(data, aes(x= Northing, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meanTD,sitevars$meanSOM))
colnames(data) =cbind("meanTD","meanSOM")
g6 = ggplot(data, aes(x= meanTD, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meanTD,sitevars$Northing))
colnames(data) =cbind("meanTD","Northing")
g7 = ggplot(data, aes(x= meanTD, y = Northing))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$BufferI, sitevars$Northing))
colnames(data) =cbind("BufferI","Northing")
g8 = ggplot(data, aes(x= BufferI, y = Northing))+
geom_point()+
geom_smooth(method = lm)
grid.arrange(g7,g8)
#grid.arrange(g1,g2,g3,g4,g5,g6,g7, nrow =2)
data = as.data.frame(cbind(sitevars$meandbh,sitevars$Northing))
colnames(data) =cbind("meandbh","Northing")
g1 = ggplot(data, aes(x= meandbh, y = Northing))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meandbh, sitevars$meanph))
colnames(data) = cbind("meandbh","meanph")
g2 = ggplot(data, aes(x= meandbh, y = meanph))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meandbh,sitevars$meanSOM))
colnames(data) =cbind("meandbh","meanSOM")
g3 = ggplot(data, aes(x= meandbh, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meanph,sitevars$meanSOM))
colnames(data) =cbind("meanph","meanSOM")
g4 = ggplot(data, aes(x= meanph, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$Northing,sitevars$meanSOM))
colnames(data) =cbind("Northing","meanSOM")
g5 = ggplot(data, aes(x= Northing, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meanTD,sitevars$meanSOM))
colnames(data) =cbind("meanTD","meanSOM")
g6 = ggplot(data, aes(x= meanTD, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meanTD,sitevars$Northing))
colnames(data) =cbind("meanTD","Northing")
g7 = ggplot(data, aes(x= meanTD, y = Northing))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$BufferI, sitevars$Northing))
colnames(data) =cbind("BufferI","Northing")
g8 = ggplot(data, aes(x= BufferI, y = Northing))+
geom_point()+
geom_smooth(method = lm)
g9 = ggplot(sitevars, aes(x = Northing, y = mean_L))+
geom_point()+
geom_smooth(method = lm)
g10 = ggplot(sitevars, aes(x = meanTD, y = mean_L))+
geom_point() +
geom_smooth(method = lm)
data = as.data
data = as.data.frame(cbind(sitevars$meandbh,sitevars$Northing))
colnames(data) =cbind("meandbh","Northing")
g1 = ggplot(data, aes(x= meandbh, y = Northing))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meandbh, sitevars$meanph))
colnames(data) = cbind("meandbh","meanph")
g2 = ggplot(data, aes(x= meandbh, y = meanph))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meandbh,sitevars$meanSOM))
colnames(data) =cbind("meandbh","meanSOM")
g3 = ggplot(data, aes(x= meandbh, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meanph,sitevars$meanSOM))
colnames(data) =cbind("meanph","meanSOM")
g4 = ggplot(data, aes(x= meanph, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$Northing,sitevars$meanSOM))
colnames(data) =cbind("Northing","meanSOM")
g5 = ggplot(data, aes(x= Northing, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meanTD,sitevars$meanSOM))
colnames(data) =cbind("meanTD","meanSOM")
g6 = ggplot(data, aes(x= meanTD, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meanTD,sitevars$Northing))
colnames(data) =cbind("meanTD","Northing")
g7 = ggplot(data, aes(x= meanTD, y = Northing))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$BufferI, sitevars$Northing))
colnames(data) =cbind("BufferI","Northing")
g8 = ggplot(data, aes(x= BufferI, y = Northing))+
geom_point()+
geom_smooth(method = lm)
g9 = ggplot(sitevars, aes(x = Northing, y = mean_L))+
geom_point()+
geom_smooth(method = lm)
g10 = ggplot(sitevars, aes(x = meanTD, y = mean_L))+
geom_point() +
geom_smooth(method = lm)
grid.arrange(g7,g8)
#grid.arrange(g1,g2,g3,g4,g5,g6,g7, nrow =2)
g7 = ggplot(data, aes(x= meanTD, y = Northing))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$BufferI, sitevars$Northing))
colnames(data) =cbind("BufferI","Northing")
g8 = ggplot(data, aes(x= BufferI, y = Northing))+
geom_point()+
geom_smooth(method = lm)
g9 = ggplot(sitevars, aes(x = Northing, y = mean_L))+
geom_point()+
geom_smooth(method = lm)
g10 = ggplot(sitevars, aes(x = meanTD, y = mean_L))+
geom_point() +
geom_smooth(method = lm)
grid.arrange(g7,g8,g9,g10, nrow = 2)
sitevars =  read.csv("../../Data/CompleteSiteLevelVars.csv")
sitevars[is.na(sitevars)]=0
#toremove = c(23,53,74)
#sitevars = sitevars%>%filter(!Site %in% toremove)
names(sitevars)[names(sitevars) =="Pos_Hetero_Index"] = "PHI"
names(sitevars)[names(sitevars) =="meantreedensity"] = "meanTD"
# after this analysis I am adding arable buffers
ArableBuffer = read.csv( "../../Data/LandCoverIndicesArable.csv")
BufferI = ArableBuffer%>%select("X","Buffer1")
colnames(BufferI) = c("Site","BufferI")
sitevars= inner_join(BufferI, sitevars)
sitevars_reduced = subset(sitevars, select = -c(X,Site,No.of.Des, Any.Anc,Buffer1,Buffer2,sd_pH,
sd_SOM,sd_LBA, sd_meandbh,sd_treedensity,
sd_R,mean_R, sd_N,mean_N , sd_W, mean_W,
sd_L, mean_L, no_trees ))
BufferI = ArableBuffer%>%select("X","Buffer1")
colnames(BufferI) = c("Site","BufferI")
sitevars= inner_join(BufferI, sitevars)
sitevars_all_lesRich = subset(sitevars_reduced, select = -c(Richness))
vars = as.vector(colnames(sitevars_reduced))
vars
# after this analysis I am adding arable buffers
data = as.data.frame(cbind(sitevars$meandbh,sitevars$Northing))
colnames(data) =cbind("meandbh","Northing")
g1 = ggplot(data, aes(x= meandbh, y = Northing))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meandbh, sitevars$meanph))
colnames(data) = cbind("meandbh","meanph")
g2 = ggplot(data, aes(x= meandbh, y = meanph))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meandbh,sitevars$meanSOM))
colnames(data) =cbind("meandbh","meanSOM")
g3 = ggplot(data, aes(x= meandbh, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meanph,sitevars$meanSOM))
colnames(data) =cbind("meanph","meanSOM")
g4 = ggplot(data, aes(x= meanph, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$Northing,sitevars$meanSOM))
colnames(data) =cbind("Northing","meanSOM")
g5 = ggplot(data, aes(x= Northing, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meanTD,sitevars$meanSOM))
colnames(data) =cbind("meanTD","meanSOM")
g6 = ggplot(data, aes(x= meanTD, y = meanSOM))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$meanTD,sitevars$Northing))
colnames(data) =cbind("meanTD","Northing")
g7 = ggplot(data, aes(x= meanTD, y = Northing))+
geom_point()+
geom_smooth(method = lm)
data = as.data.frame(cbind(sitevars$BufferI, sitevars$Northing))
colnames(data) =cbind("BufferI","Northing")
g8 = ggplot(data, aes(x= BufferI, y = Northing))+
geom_point()+
geom_smooth(method = lm)
g9 = ggplot(sitevars, aes(x = Northing, y = mean_L))+
geom_point()+
geom_smooth(method = lm)
g10 = ggplot(sitevars, aes(x = meanTD, y = mean_L))+
geom_point() +
geom_smooth(method = lm)
grid.arrange(g7,g8,g9,g10, nrow = 2)
#grid.arrange(g1,g2,g3,g4,g5,g6,g7, nrow =2)
View(sitevars)
ggplot(Sitevars, aes(x = mean_L, y = Richness ))+ geom_smooth(method = lm)
ggplot(sitevars, aes(x = mean_L, y = Richness ))+ geom_smooth(method = lm)
# To create positive heterogeneity indices
#INPUTS LookUpSiteDescriptorCodes.csv, Site_descriptors00-03, access
#OUTPUTS PositiveHeterogIndices.csv and NegativeHeterogIndies
knitr::opts_chunk$set(echo = FALSE)
library(dplyr)
library(ggplot2)
library(gridExtra)
# these codes imply open areas, 8 - 10 are coppicing, 86 -93 are larger water features, 105-117 are glades and tracks
#208 - 212 are heaths, marsh, rivers and lakes.
PositiveCodesSites = c(8,9,10,12,13,14,15,16,17,18,24,54,55,56,57,58,59,61,62,63,64,65,86,87,88,89,90,91,92,93,105,106,107,108,109,110,111,112,113,114,115,116,150,151,152,153,157,158,208,209,210,211,212)
PositveSites = SiteDescriptorsYr2 %>% select(SITE, SD_code)%>% filter(SD_code %in% PositiveCodesSites)
#Get the data , enter input CSV file name here, for data in data directory
inputfile = 'LookUpSiteDescriptorCodes.csv'
fullfile = paste("../Data",inputfile, sep = "/")
LookUpSite = as.tbl(read.csv(fullfile))
inputfile = 'Site_descriptors00-03.csv'
fullfile = paste("../Data",inputfile, sep = "/")
SiteDescriptorsYr2 = as.tbl(read.csv(fullfile))
# these codes imply open areas, 8 - 10 are coppicing, 86 -93 are larger water features, 105-117 are glades and tracks
#208 - 212 are heaths, marsh, rivers and lakes.
PositiveCodesSites = c(8,9,10,12,13,14,15,16,17,18,24,54,55,56,57,58,59,61,62,63,64,65,86,87,88,89,90,91,92,93,105,106,107,108,109,110,111,112,113,114,115,116,150,151,152,153,157,158,208,209,210,211,212)
PositveSites = SiteDescriptorsYr2 %>% select(SITE, SD_code)%>% filter(SD_code %in% PositiveCodesSites)
poscodesused =  LookUpSite%>%filter(SD_code%in% PositiveCodesSites)
poscodesused = poscodesused%>%select(SD_code,Description)
write.csv(poscodesused, "../Data/PosCodesUsed")
# these codes imply open areas, 8 - 10 are coppicing, 86 -93 are larger water features, 105-117 are glades and tracks
#208 - 212 are heaths, marsh, rivers and lakes.
PositiveCodesSites = c(8,9,10,12,13,14,15,16,17,18,24,25,86,87,88,89,90,91,92,93,100,101,103,105,106,107,108,109,110,113,114,115,116,208,209,210,211,212)
PositveSites = SiteDescriptorsYr2 %>% select(SITE, SD_code)%>% filter(SD_code %in% PositiveCodesSites)
poscodesused =  LookUpSite%>%filter(SD_code%in% PositiveCodesSites)
poscodesused = poscodesused%>%select(SD_code,Description)
write.csv(poscodesused, "../Data/PosCodesUsed")
#dont think this adds anything
ggplot(SiteDescriptorsYr2, aes(SiteDescriptorsYr2$SD_code)) +
geom_histogram(breaks = seq(1,250, by = 10), col = "black", fill = "green")+
labs(title = "Frequeny of All Site Descriptor Codes", x = "Site descriptor code", y = "Count")
ggplot(PositveSites, aes(x = SD_code)) +
geom_histogram(breaks = seq(1,220, by = 10), col = "black", fill = "green")+
labs(title = "Positive Site Descriptor Codes", x = "Site descriptor code", y = "Count in data")
NegativeCodesSites = c(6,41,143,145,149,117,213,215)
NegativeSites = SiteDescriptorsYr2 %>% select(SITE, SD_code)%>% filter(SD_code %in% NegativeCodesSites)
ggplot(NegativeSites, aes(x = SD_code)) +
geom_histogram(breaks = seq(1,250, by = 10), col = "black", fill = "green")+
labs(title = "Negative Site Descriptor Codes", x = "SD code", y = "Count in data")
#the heterogeneity index for each site is the sum of the positive codes
PositiveHeterogIndices = PositveSites %>% group_by(SITE)%>% summarise(no_rows = length(SITE))
#max = (max(SiteHeterogenity$no_rows))
#means = round(mean(SiteHeterogenity$no_rows), digits = 2)
#min = (min(SiteHeterogenity$no_rows))
#stats =  tableGrob(rbind(max,means,min))
ggplot(data = PositiveHeterogIndices, aes(x = SITE, y = no_rows)) +
geom_bar(stat = "identity", col = "black")+
labs(title = "Positive Heterogenity Indices by Site", x = "Site", y = "Number of positive codes")
#grid.arrange(stats,p, ncol = 2)
#the heterogeneity index for each site is the sum of the positive codes
NegativeHeterogIndices = NegativeSites %>% group_by(SITE)%>% summarise(no_rows = length(SITE))
ggplot(data = NegativeHeterogIndices, aes(x = SITE, y = no_rows)) +
geom_bar(stat = "identity", col = "black")+
labs(title = "Negative Heterogenity Indices by Site", x = "Site", y = "Number of negative codes")
#save the indices to merge with the site data
colnames(PositiveHeterogIndices) = c("Site", "Pos_Hetero_Index")
colnames(NegativeHeterogIndices) = c("Site", "Neg_Hetero_Index")
# Some sites have no records, so ensure 0 appears, not missing row.
Sitedf = as.data.frame( c(1:103))
colnames(Sitedf) = "Site"
PositiveHeterogIndices = right_join(PositiveHeterogIndices,Sitedf)
NegativeHeterogIndices = right_join(NegativeHeterogIndices,Sitedf)
PositiveHeterogIndices = write.csv(PositiveHeterogIndices,"../Data/PositiveHeterogIndices.csv")
NegativeHeterogIndices = write.csv(NegativeHeterogIndices, "../Data/NegativeHeterogIndices.csv")
# these are the positive codes used
positive_key = subset(LookUpSite, SD_code %in% PositiveCodesSites)
positive_key
write.csv(positive_key, "../Results/Positive_codes_used.csv")
# these are the negative codes used
negative_key = subset(LookUpSite, SD_code %in% NegativeCodesSites)
negative_key
write.csv(negative_key,"../Results/Negative_codes_used.csv")
source('~/Documents/CMEECourseWork/CMEEMainProject/Code/CreatingAllSiteVars.R', echo=TRUE)
knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE,
out.width="60%"
)
rm(list = ls())
cat("\014")
library(dplyr)
library(visreg) # for visreg plots
library(ggplot2)
library(GGally) # for ggpairs
library(factoextra)
library(FactoMineR)# these two for PCA
library(corrplot)
library(car)
library(gridExtra)
library(reshape)
library(knitr)
library(kableExtra)
sitevars =  read.csv("../../Data/CompleteSiteLevelVars.csv")
sitevars[is.na(sitevars)]=0
#toremove = c(23,53,74)
#sitevars = sitevars%>%filter(!Site %in% toremove)
names(sitevars)[names(sitevars) =="Pos_Hetero_Index"] = "PHI"
names(sitevars)[names(sitevars) =="meantreedensity"] = "meanTD"
# after this analysis I am adding arable buffers
ArableBuffer = read.csv( "../../Data/LandCoverIndicesArable.csv")
BufferI = ArableBuffer%>%select("X","Buffer1")
colnames(BufferI) = c("Site","BufferI")
sitevars= inner_join(BufferI, sitevars)
sitevars_reduced = subset(sitevars, select = -c(X,Site,No.of.Des, Any.Anc,Buffer1,Buffer2,sd_pH,
sd_SOM,sd_LBA, sd_meandbh,sd_treedensity,
sd_R,mean_R, sd_N,mean_N , sd_W, mean_W,
sd_L, mean_L, no_trees ))
BufferI = ArableBuffer%>%select("X","Buffer1")
colnames(BufferI) = c("Site","BufferI")
sitevars= inner_join(BufferI, sitevars)
sitevars_all_lesRich = subset(sitevars_reduced, select = -c(Richness))
vars = as.vector(colnames(sitevars_reduced))
vars
# after this analysis I am adding arable buffers
model_all = lm(Richness ~., data = sitevars_reduced)
visreg(model_all)
