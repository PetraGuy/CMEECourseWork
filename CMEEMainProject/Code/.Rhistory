geom_line(aes(x=log(area), y = predict(model), group = plot), colour = "red")+
xlim(lower = 0, upper = 6)+
ylim(lower = 0, upper = 6)+
ggtite(title)
title = paste("Site", i)
ggplot(melted_cf)+
geom_point(aes(x=log(area),y=log(value),na.rm =TRUE), colour = "black") +
geom_line(aes(x=log(area), y = predict(model), group = plot), colour = "red")+
xlim(lower = 0, upper = 6)+
ylim(lower = 0, upper = 6)+
ggtitle(title)
title = paste("Site", i)
ggplot(melted_cf)+
geom_point(aes(x=log(area),y=log(value),na.rm =TRUE), colour = "black") +
geom_line(aes(x=log(area), y = predict(model), group = plot), colour = "red")+
xlim(lower = 0, upper = 6)+
ylim(lower = -0.2, upper = 6)+
ggtitle(title)
xlim(lower = 0, upper = 6)+
ylim(lower = -1, upper = 5)+
ggtitle(title)
title = paste("Site", i)
ggplot(melted_cf)+
geom_point(aes(x=log(area),y=log(value),na.rm =TRUE), colour = "black") +
geom_line(aes(x=log(area), y = predict(model), group = plot), colour = "red")+
xlim(lower = 0, upper = 6)+
ylim(lower = -1, upper = 5)+
ggtitle(title)
i = 78
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
title = paste("Site", i)
ggplot(melted_cf)+
geom_point(aes(x=log(area),y=log(value),na.rm =TRUE), colour = "black") +
geom_line(aes(x=log(area), y = predict(model), group = plot), colour = "red")+
xlim(lower = 0, upper = 6)+
ylim(lower = -1, upper = 5)+
ggtitle(title)
title = paste("Site", i)
ggplot(melted_cf)+
geom_point(aes(x=log(area),y=log(value),na.rm =TRUE), colour = "black") +
geom_line(aes(x=log(area), y = predict(model), group = plot), colour = "red")+
xlim(lower = 0, upper = 6)+
ylim(lower = -1, upper = 5)+
ggtitle(title)
i = 66
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
#get coefficients
title = paste("Site", i)
ggplot(melted_cf)+
geom_point(aes(x=log(area),y=log(value),na.rm =TRUE), colour = "black") +
geom_line(aes(x=log(area), y = predict(model), group = plot), colour = "red")+
xlim(lower = 0, upper = 6)+
ylim(lower = -1, upper = 5)+
ggtitle(title)
i = 78
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
#get coefficients
title = paste("Site", i)
ggplot(melted_cf)+
geom_point(aes(x=log(area),y=log(value),na.rm =TRUE), colour = "black") +
geom_line(aes(x=log(area), y = predict(model), group = plot), colour = "red")+
xlim(lower = 0, upper = 6)+
ylim(lower = -1, upper = 5)+
ggtitle(title)
i = 19
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
#get coefficients
title = paste("Site", i)
ggplot(melted_cf)+
geom_point(aes(x=log(area),y=log(value),na.rm =TRUE), colour = "black") +
geom_line(aes(x=log(area), y = predict(model), group = plot), colour = "red")+
xlim(lower = 0, upper = 6)+
ylim(lower = -1, upper = 5)+
ggtitle(title)
plotvars%>%filter(Site == 19)
i = 19
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
melted_cf
cf_site
melted_cf
cf_site = plot_cum_richess[[i]]
cf_site = plot_cum_richess[[19]]
cf_site
plotvars%>%select(Site == 19)
View(plotvars)
View(plotvars)
plotvars%>%filter(Site == 19)
#Input all the ground flora data
Data = read.csv("../Data/GroundCover.csv")
Data_Yr2 = Data%>%filter(Yr_2 == 2)#%>%select(SITE,PLOT,NEST,COV,Amalgams)
colnames(Data_Yr2) = c("SITE", "PLOT","NEST","Cover","BRC_number","Year")
veg_codes = read.csv("../Data/vegetation_codes.csv")
# the  bryophytes, lichen etc have already been removed from these, so the veg codes csv files is no bryophytes, so need to join this with ground cover to eliminate bryophytes from counts
colnames(veg_codes) = c("Species", "BRC_number")
Data_Yr2_veg = Data_Yr2%>% inner_join(veg_codes)
# now using Dat_Yr2_veg means analysis is carried out without bryophytes
View(Data)
Data%>%fileter(Site == 19)
Data%>%filter(Site == 19)
Data%>%filter(SITE == 19)
S19 = Data%>%filter(SITE == 19)
View(S19)
View(S19)
S19 = Data_Yr2_veg%>%filter(SITE == 19)%>%(PLOT == 13)
S19 = Data_Yr2_veg%>%filter(SITE == 19)%>%filter(PLOT == 13)
View(S19)
View(S19)
plotvars%>%filter(Site == 78)
plotvars%>%filter(Site == 83)
View(sitevars)
View(sitevars)
plotvars%>%filter(Site == 50)
i = 50
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
#get coefficients
title = paste("Site", i)
ggplot(melted_cf)+
geom_point(aes(x=log(area),y=log(value),na.rm =TRUE), colour = "black") +
geom_line(aes(x=log(area), y = predict(model), group = plot), colour = "red")+
xlim(lower = 0, upper = 6)+
ylim(lower = -1, upper = 5)+
ggtitle(title)
View(sitevars)
i = 57
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
title = paste("Site", i)
ggplot(melted_cf)+
geom_point(aes(x=log(area),y=log(value),na.rm =TRUE), colour = "black") +
geom_line(aes(x=log(area), y = predict(model), group = plot), colour = "red")+
xlim(lower = 0, upper = 6)+
ylim(lower = -1, upper = 5)+
ggtitle(title)
i = 81
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
title = paste("Site", i)
ggplot(melted_cf)+
geom_point(aes(x=log(area),y=log(value),na.rm =TRUE), colour = "black") +
geom_line(aes(x=log(area), y = predict(model), group = plot), colour = "red")+
xlim(lower = 0, upper = 6)+
ylim(lower = -1, upper = 5)+
ggtitle(title)
plotvars%>%filter(Site == 81)
title = paste("Site", i)
ggplot(melted_cf)+
geom_point(aes(x=log(area),y=log(value),na.rm =TRUE), colour = "black") +
geom_line(aes(x=log(area), y = predict(model), group = plot), colour = plot)+
xlim(lower = 0, upper = 6)+
ylim(lower = -1, upper = 5)+
ggtitle(title)
title = paste("Site", i)
ggplot(melted_cf)+
geom_point(aes(x=log(area),y=log(value),na.rm =TRUE), colour = "black") +
geom_line(aes(x=log(area), y = predict(model), group = plot, colour = plot))+
xlim(lower = 0, upper = 6)+
ylim(lower = -1, upper = 5)+
ggtitle(title)
title = paste("Site", i)
ggplot(melted_cf)+
geom_point(aes(x=log(area),y=log(value),na.rm =TRUE), colour = "black") +
geom_line(aes(x=log(area), y = predict(model), group = plot), colour = plot)+
xlim(lower = 0, upper = 6)+
ylim(lower = -1, upper = 5)+
ggtitle(title)
i = 78
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
title = paste("Site", i)
ggplot(melted_cf)+
geom_point(aes(x=log(area),y=log(value),na.rm =TRUE), colour = "black") +
geom_line(aes(x=log(area), y = predict(model), group = plot, colour = plot))+
xlim(lower = 0, upper = 6)+
ylim(lower = -1, upper = 5)+
ggtitle(title)
i = 19
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
#get coefficients
title = paste("Site", i)
ggplot(melted_cf)+
geom_point(aes(x=log(area),y=log(value),na.rm =TRUE), colour = "black") +
geom_line(aes(x=log(area), y = predict(model), group = plot, colour = plot))+
xlim(lower = 0, upper = 6)+
ylim(lower = -1, upper = 5)+
ggtitle(title)
i = 52
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
#get coefficients
title = paste("Site", i)
ggplot(melted_cf)+
geom_point(aes(x=log(area),y=log(value),na.rm =TRUE), colour = "black") +
geom_line(aes(x=log(area), y = predict(model), group = plot, colour = plot))+
xlim(lower = 0, upper = 6)+
ylim(lower = -1, upper = 5)+
ggtitle(title)
site81 = plotvars%>%filter(Site == 81)
site81
site52 = plotvars%>%filter(Site == 52)
View(sitevars)
sitevars%>%filter(Site == 81)%>%select(Richness)
sitevars%>%filter(Site == 52)%>%select(Richness)
plotvars%>%filter(Site == 5)
model
VarCorr(model)
model$coefficients
model$contrasts
model$modelStruct
model$sigma
summary(model)
s = summary(model)
s$fitted
s$contrasts
s$coefficients
s$varFix
s$sigma
model
s$apVar
s$groups
s$terms
s$residuals
s$tTable
model
model$call
VarCorr(model)
model
varrcorr[,2]
v = VarCorr(model)
v[,2]
model
v[1,2]
fits_all_woods = function(){
coef_df = data.frame(matrix(ncol = 2, nrow = 0))
for (i in 1:103){
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
#get coefficients
int = model$coefficients$fixed[[1]]
slope = model$coefficients$fixed[[2]]
p_slope = summary(model)$tTable[2,5]
sd = VarCorr(model)[1,2]
row = c(int,slope, p_slope,sd)
coef_df = rbind(coef_df,row)
}
colnames(coef_df) = c("intercept","slope","p_slope","sd_intercept")
return(coef_df)
}
fits = fits_all_woods(
)
View(fits)
fits_all_woods = function(){
coef_df = data.frame(matrix(ncol = 2, nrow = 0))
for (i in 1:103){
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
#get coefficients
int = model$coefficients$fixed[[1]]
slope = model$coefficients$fixed[[2]]
p_slope = summary(model)$tTable[2,5]
sd = VarCorr(model)[1,2]
row = c(int,slope, p_slope,sd)
coef_df = rbind(coef_df,row)
}
colnames(coef_df) = c("intercept","slope","p_slope","sd_intercept")
return(coef_df)
}
fits = fits_all_woods()
View(fits)
coef_df = data.frame(matrix(ncol = 2, nrow = 0))
fits_all_woods = function(){
coef_df = data.frame(matrix(ncol = 2, nrow = 0))
for (i in 1:103){
browser()
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
#get coefficients
int = model$coefficients$fixed[[1]]
slope = model$coefficients$fixed[[2]]
p_slope = summary(model)$tTable[2,5]
sd = VarCorr(model)[1,2]
row = c(int,slope, p_slope,sd)
coef_df = rbind(coef_df,row)
}
colnames(coef_df) = c("intercept","slope","p_slope","sd_intercept")
return(coef_df)
}
fits = fits_all_woods()
coef_df
View(coef_df)
View(coef_df)
coef_df = data.frame()
for (i in 1:103){
#browser()
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
#get coefficients
int = model$coefficients$fixed[[1]]
slope = model$coefficients$fixed[[2]]
p_slope = summary(model)$tTable[2,5]
sd = VarCorr(model)[1,2]
row = c(int,slope, p_slope,sd)
coef_df = rbind(coef_df,row)
}
colnames(coef_df) = c("intercept","slope","p_slope","sd_intercept")
return(coef_df)
q
coef_df = data.frame()
coef_df = data.frame()
fits_all_woods = function(){
for (i in 1:103){
#browser()
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
#get coefficients
int = model$coefficients$fixed[[1]]
slope = model$coefficients$fixed[[2]]
p_slope = summary(model)$tTable[2,5]
sd = VarCorr(model)[1,2]
row = c(int,slope, p_slope,sd)
coef_df = rbind(coef_df,row)
}
colnames(coef_df) = c("intercept","slope","p_slope","sd_intercept")
return(coef_df)
}
fits = fits_all_woods()
View(fits)
View(coef_df)
for (i in 1:103){
browser()
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
#get coefficients
int = model$coefficients$fixed[[1]]
slope = model$coefficients$fixed[[2]]
p_slope = summary(model)$tTable[2,5]
sd = VarCorr(model)[1,2]
row = c(int,slope, p_slope,sd)
coef_df = rbind(coef_df,row)
}
colnames(coef_df) = c("intercept","slope","p_slope","sd_intercept")
return(coef_df)
}
fits = fits_all_woods()
View(coef_df)
fits_all_woods = function(){
for (i in 1:103){
browser()
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
#get coefficients
int = model$coefficients$fixed[[1]]
slope = model$coefficients$fixed[[2]]
p_slope = summary(model)$tTable[2,5]
sd = VarCorr(model)[1,2]
row = c(int,slope, p_slope,sd)
coef_df = rbind(coef_df,row)
}
colnames(coef_df) = c("intercept","slope","p_slope","sd_intercept")
return(coef_df)
}
coef_df = data.frame()
fits_all_woods = function(){
for (i in 1:103){
browser()
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
#get coefficients
int = model$coefficients$fixed[[1]]
slope = model$coefficients$fixed[[2]]
p_slope = summary(model)$tTable[2,5]
sd = VarCorr(model)[1,2]
row = c(int,slope, p_slope,sd)
coef_df = rbind(coef_df,row)
}
colnames(coef_df) = c("intercept","slope","p_slope","sd_intercept")
return(coef_df)
}
fits = fits_all_woods()
View(coef_df)
View(coef_df)
View(coef_df)
View(coef_df)
View(coef_df)
coef_df = data.frame()
fits_all_woods = function(){
for (i in 1:103){
browser()
cf_site = plot_cum_richess[[i]]
cf_site$plot = plots
melted_cf = melt(cf_site)
melted_cf[melted_cf == 0] = NA # if a site has missing plots they will be zeros
melted_cf$area = areas
model = lme(log(value)~log(area),random = ~1|plot, data = melted_cf, na.action = na.omit)
#get coefficients
int = model$coefficients$fixed[[1]]
slope = model$coefficients$fixed[[2]]
p_slope = summary(model)$tTable[2,5]
sd = VarCorr(model)[1,2]
row = c(int,slope, p_slope,sd)
coef_df = as.data.frame(rbind(coef_df,row))
}
colnames(coef_df) = c("intercept","slope","p_slope","sd_intercept")
return(coef_df)
}
fits = fits_all_woods()
View(coef_df)
coef_df
View(coef_df)
coef_df = data.frame()
row = c(1,2,3,4)
row
coef_df = rbind(coef_df,row)
coef_df
row = c(3,4,5,6)
coef_df = rbind(coef_df,row)
coef_df
setwd("C:/dev/code/CMEECourseWork/CMEEMainProject/Code")
source('C:/dev/code/CMEECourseWork/CMEEMainProject/Code/SAC_plot.R')
install.packages("dplyr")
source('C:/dev/code/CMEECourseWork/CMEEMainProject/Code/SAC_plot.R')
install.packages("ggplot")
installed.packages()
install.packages("ggplot2")
install.packages(nlme)
install.packages("nlme")
installed.packages()
install.packages("gridExtra")
source('C:/dev/code/CMEECourseWork/CMEEMainProject/Code/SAC_plot.R')
grid.arrange(g1,g2,g3,g4, nrow = 2)
