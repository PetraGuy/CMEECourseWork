w8low2
w8high1
w8high2
View(groundcover)
View(AllPlotsvars)
View(databigNVC)
View(W16)
w16all = AllPlotsvars%>%filter(ShortNVC=="W16")
View(w16all)
View(w10)
View(W8all)
View(groundcover)
View(AllPlotsvars)
allw10 = get_all_plots(W10)
get_all_plots = function(nvc){
allplots = AllPlotsvars%>%filter(ShortNVC==nvc)
return(allplots)
}
allw10 = get_all_plots(W10)
nvc= W10
allplots = AllPlotsvars%>%filter(ShortNVC==nvc)
nvc =  as.character(nvc)
allplots = AllPlotsvars%>%filter(ShortNVC == nvc)
allw10 = get_all_plots(W10)
get_all_plots = function(nvc){
nvc =  as.character(nvc)
allplots = AllPlotsvars%>%filter(ShortNVC == nvc)
return(allplots)
}
allw10 = get_all_plots(W10)
View(allw10)
View(allw10)
View(AllPlotsvars)
View(allplots)
nvc
nvc = "W10"
nvc =  as.character(nvc)
nvc
allplots = AllPlotsvars%>%filter(ShortNVC == nvc)
View(allplots)
get_all_plots = function(nvc){
nvc =  as.character(nvc)
allplots = AllPlotsvars%>%filter(ShortNVC == nvc)
return(allplots)
}
allw10 = get_all_plots("W10")
View(groundcover)
View(allplots)
View(groundcover)
View(Ellenbergs)
View(groundcover)
library(dplyr)
require(ggplot2)
require(reshape)
library(gridExtra)
rm(list = ls())
cat("\014")
site_data =  read.csv("../Data/CompleteSiteLevelVars.csv")
AllPlotsvars = read.csv("../Data/AllPlotsVarsRichness.csv")
Ellenbergs = read.csv("../Data/Ellenbergs.csv")
colnames(Ellenbergs) = c("Amalgams","Taxon.name","L" , "F" ,  "R" , "N" ,  "S" )
Ellenbergs$Amalgams = gsub(" ", "", Ellenbergs$Amalgams, fixed = TRUE)
Ellenbergs$Amalgams = as.numeric(Ellenbergs$Amalgams)
vegcodes = read.csv("../Data/vegetation_codes.csv")
colnames(vegcodes) = c("Species","Amalgams")
groundcover = read.csv("../data/GroundCover.csv")
cover_ellenbergs = inner_join(groundcover,Ellenbergs)
View(cover_ellenbergs)
get_all_plots = function(nvc){
nvc =  as.character(nvc)
allplots = AllPlotsvars%>%filter(ShortNVC == nvc)
return(allplots)
}
w10plots = get_all_plots("W10")
View(w10plots)
nrow(w10plots)
View(cover_ellenbergs)
View(cover_ellenbergs)
View(w10plots)
w10plots[1,2]
row = 1
site = allplots[row,2]
allplots = w10plots
site = allplots[row,2]
plot = allplots[row,3]
View(cover_ellenbergs)
ave_N = mean(cover_ellenbergs%>%filter(Site = site)%>%filter(PLOT == plot)$N)
ave_N = mean(cover_ellenbergs%>%filter(Site == site)%>%filter(PLOT == plot)$N)
ave_N = mean(cover_ellenbergs%>%filter(SITE == site)%>%filter(PLOT == plot)$N)
plants = cover_ellenbergs%>%filter(SITE == site)%>%filter(PLOT == plot)
View(plants)
ave_N = mean(plants$N)
ave_R = mean(plants$R)
ave_N = round(mean(plants$N,2)
ave_R = round(mean(plants$R),2)
ave_N = round(mean(plants$N),2)
ave_R = round(mean(plants$R),2)
View(allplots)
allplots[1,]
allplots[row,]$SOMYr2
df = data.frame()
colnames(df) = c("SOM","ave_N","ave_R")
df = data.frame(ncol = 3, nrow = rows)
rows = nrow(alllplots)
allplots = w10plots
rows = nrow(alllplots)
rows = nrow(allplots)
df = data.frame(ncol = 3, nrow = rows)
View(df)
df = data.frame()
ave_N = round(mean(plants$N),2)
ave_R = round(mean(plants$R),2)
SOM = allplots[row,]$SOMYr2
thisrow = c(SOM,ave_N,ave_R)
df = rbind(df,thisrow)
View(df)
colnames(df) = c("SOM","ave_N","ave_R")
View(df)
get_ellens = function(allplots){
rows = nrow(allplots)
df = data.frame()
for(row in 1:rows){
site = allplots[row,2]
plot = allplots[row,3]
plants = cover_ellenbergs%>%filter(SITE == site)%>%filter(PLOT == plot)
ave_N = round(mean(plants$N),2)
ave_R = round(mean(plants$R),2)
SOM = allplots[row,]$SOMYr2
thisrow = c(SOM,ave_N,ave_R)
df = rbind(df,thisrow)
}
colnames(df) = c("SOM","ave_N","ave_R")
return(df)
}
get_som_ellens = funtion(nvc){
allplots = get_all_plots(nvc)
ellensdf = get_ellens(allplots)
return(ellensdf)
}
get_som_ellens = funtion(nvc){
allplots = get_all_plots(nvc)
ellensdf = get_ellens(allplots)
return(ellensdf)
}
get_som_ellens = function(nvc){
allplots = get_all_plots(nvc)
ellensdf = get_ellens(allplots)
return(ellensdf)
}
w10vals = get_som_ellens("W10")
View(w10vals)
w10plot = ggplot(w10vals, aes(x = SOM))+
geom_point(aes(y = ave_N))+
geom_point(aes(y = ave_R))
w10plot
ggplot(w10vals, aes(x = SOM))+
geom_point(aes(y = ave_N), colour = "blue")+
geom_point(aes(y = ave_R), colour = "red")
ggplot(w10vals, aes(x = SOM))+
geom_point(aes(y = ave_N), colour = "blue")+geom_smooth(method = "lm", colour = "blue")+
geom_point(aes(y = ave_R), colour = "red")+geom_smooth(method = "lm", colour = "red")
ggplot(w10vals, aes(x = SOM))+
geom_point(aes(y = ave_N), colour = "blue")+
geom_smooth(method = "lm", colour = "blue")
ggplot(w10vals, aes(x = SOM))+
geom_point(aes(y = ave_N), colour = "blue")+
geom_smooth(aes(y = ave_N), method = "lm", colour = "blue")
ggplot(w10vals, aes(x = SOM))+
geom_point(aes(y = ave_N), colour = "blue")+
geom_smooth(aes(y = ave_N), method = "lm", colour = "blue")+
geom_point(aes(y = ave_R), colour = "red")+
geom_smooth(aes(y = ave_R), method = "lm", colour = "red")
View(w10vals)
melted = melt(w10vals)
View(melted)
melted = melt(w10vals, id.vars = "SOM")
View(melted)
View(melted)
ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()
ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "loess")
ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")
ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")
ylab("Average Ellenberg for plot")
ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")
w8vals = get_som_ellens("W8")
melted = melt(w10vals, id.vars = "SOM")
w6plot = ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")
w8vals = get_som_ellens("W8")
melted = melt(w8vals, id.vars = "SOM")
w8plot = ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")
w8plot
w6vals = get_som_ellens("W6")
melted = melt(w6vals, id.vars = "SOM")
w6plot = ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot"
)
w6plt
w6plot
w16vals = get_som_ellens("W16")
melted = melt(w16vals, id.vars = "SOM")
w16plot = ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")
w16plot
w21vals = get_som_ellens("W21")
melted = melt(w21vals, id.vars = "SOM")
w8plot = ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")
w21plot
w21vals = get_som_ellens("W21")
melted = melt(w21vals, id.vars = "SOM")
w21plot = ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")
w21plot
ov27vals = get_som_ellens("W8")
melted = melt(ov27vals, id.vars = "SOM")
ov27plot = ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")
ov27plot
View(AllPlotsvars)
data =  AllPlotsvars%>%select(ShortNVC,SOMYr2,pHYr2,plot_richness)
data = data[order(data$ShortNVC),]
View(data)
AllNVC = data$ShortNVC
AllNVC
AllNVC = unique(data$ShortNVC)
AllNVC
codefreq = as.data.frame(table(AllPlotsvars$ShortNVC))
codefreq = codefreq[order(codefreq$Freq),]
codefreq
View(AllPlotsvars)
w6 =  AllPlotsvars%>%filter(ShortNVC =="W6")
w2 =  AllPlotsvars%>%filter(ShortNVC =="W2")
View(w2)
w3 =  AllPlotsvars%>%filter(ShortNVC =="W3")
w5 =  AllPlotsvars%>%filter(ShortNVC =="W5")
w5 =  AllPlotsvars%>%filter(ShortNVC =="M6")
m6 =  AllPlotsvars%>%filter(ShortNVC =="M6")
w10vals = get_som_ellens("W10")
melted = melt(w10vals, id.vars = "SOM")
w10plot = ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")+
annotate("text", x = 80, y = 6, label = "W10")
###############
w8vals = get_som_ellens("W8")
melted = melt(w8vals, id.vars = "SOM")
w8plot = ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")+
annotate("text", x = 80, y = 6, label = "W8")
###########
w6vals = get_som_ellens("W6")
melted = melt(w6vals, id.vars = "SOM")
w6plot = ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")+
annotate("text", x = 80, y = 6, label = "W6")
#############
w16vals = get_som_ellens("W16")
melted = melt(w16vals, id.vars = "SOM")
w16plot = ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")+
annotate("text", x = 80, y = 6, label = "W16")
###########
w21vals = get_som_ellens("W21")
melted = melt(w21vals, id.vars = "SOM")
w21plot = ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")+
annotate("text", x = 80, y = 6, label = "W21")
######
ov27vals = get_som_ellens("W8")
melted = melt(ov27vals, id.vars = "SOM")
ov27plot = ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")+
annotate("text", x = 80, y = 6, label = "OV27")
grid.arrange(w6plot,w8plot,w10plot,w16plot,w21plot,ov27plot, ncol = 2)
data =  AllPlotsvars%>%select(ShortNVC,SOMYr2,pHYr2,plot_richness)
codefreq = as.data.frame(table(AllPlotsvars$ShortNVC))
codefreq = codefreq[order(codefreq$Freq),]
bigNVC = codefreq%>%filter(Freq>10)
bigNVC = bigNVC[-3,]
codes = bigNVC$ShortNVC
data$ShortNVC = as.character(data$ShortNVC)
bigNVC$ShortNVC = as.character(bigNVC$ShortNVC)
colnames(bigNVC) = c("ShortNVC","Freq")
View(bigNVC)
sum(bigNVC$Freq)
View(allplots)
get_ellens = function(allplots){
rows = nrow(allplots)
df = data.frame()
for(row in 1:rows){
site = allplots[row,2]
plot = allplots[row,3]
plants = cover_ellenbergs%>%filter(SITE == site)%>%filter(PLOT == plot)
ave_N = round(mean(plants$N),2)
ave_R = round(mean(plants$R),2)
SOM = allplots[row,]$SOMYr2
pH = allplots[row,]$pHYr2
thisrow = c(SOM,pH,ave_N,ave_R)
df = rbind(df,thisrow)
}
colnames(df) = c("SOM","ave_N","ave_R")
return(df)
}
###############
w10vals = get_som_ellens("W10")
View(w10vals)
get_ellens = function(allplots){
rows = nrow(allplots)
df = data.frame()
for(row in 1:rows){
site = allplots[row,2]
plot = allplots[row,3]
plants = cover_ellenbergs%>%filter(SITE == site)%>%filter(PLOT == plot)
ave_N = round(mean(plants$N),2)
ave_R = round(mean(plants$R),2)
SOM = allplots[row,]$SOMYr2
pH = allplots[row,]$pHYr2
thisrow = c(SOM,pH,ave_N,ave_R)
df = rbind(df,thisrow)
}
colnames(df) = c("SOM","pH", "ave_N","ave_R")
return(df)
}
###############
w10vals = get_som_ellens("W10")
View(w10vals)
melted = melt(w10vals, id.vars = "SOM")
View(melted)
ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")+
annotate("text", x = 80, y = 6, label = "W10")
w10vals = get_som_ellens("W10")
melted = melt(w10vals, id.vars = "SOM")
w10plot = ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")+
annotate("text", x = 80, y = 6, label = "W10")
###############
w8vals = get_som_ellens("W8")
melted = melt(w8vals, id.vars = "SOM")
w8plot = ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")+
annotate("text", x = 80, y = 6, label = "W8")
###########
w6vals = get_som_ellens("W6")
melted = melt(w6vals, id.vars = "SOM")
w6plot = ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")+
annotate("text", x = 80, y = 6, label = "W6")
#############
w16vals = get_som_ellens("W16")
melted = melt(w16vals, id.vars = "SOM")
w16plot = ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")+
annotate("text", x = 80, y = 6, label = "W16")
###########
w21vals = get_som_ellens("W21")
melted = melt(w21vals, id.vars = "SOM")
w21plot = ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")+
annotate("text", x = 80, y = 6, label = "W21")
######
ov27vals = get_som_ellens("W8")
melted = melt(ov27vals, id.vars = "SOM")
ov27plot = ggplot(melted, aes(x = SOM, y = value, colour = variable))+
geom_point()+
geom_smooth(method = "lm")+
ylab("Average Ellenberg for plot")+
annotate("text", x = 80, y = 6, label = "OV27")
###
grid.arrange(w6plot,w8plot,w10plot,w16plot,w21plot,ov27plot, ncol = 2)
grid.arrange(w6plot,w8plot,w10plot,w16plot,w21plot,ov27plot, ncol = 2)
View(w6)
View(w6)
View(w6plot)
View(AllPlotsvars)
View(groundcover)
w10all = AllPlotsvars%>%filter(ShortNVC == "W10")
View(w10all)
w10high1= groundcover%>%filter(SITE==42)%>%filter(PLOT==16)
w10high2 = groundcover%>%filter(SITE==77)%>%filter(PLOT==13)
w10low1 = groundcover%>%filter(SITE==98)%>%filter(PLOT==5)
w10low2 = groundcover%>%filter(SITE==91)%>%filter(PLOT==12)
View(w10high1)
w10lowveg1 = inner_join(vegcodes,w10low1)
w10lowveg1ellen = inner_join(w10lowveg1,Ellenbergs)
w10lowveg2 = inner_join(vegcodes,w10low2)
w10lowveg2ellen = inner_join(w10lowveg2,Ellenbergs)
w10highveg1 = inner_join(vegcodes,w10high1)
w10highveg1ellen = inner_join(w10highveg1,Ellenbergs)
w10lowveg2 = inner_join(vegcodes,w10low2)
w10lowveg2ellen = inner_join(w10lowveg2,Ellenbergs)
w10highveg1 = inner_join(vegcodes,w10high1)
w10highveg1ellen = inner_join(w10highveg1,Ellenbergs)
w10highveg2 = inner_join(vegcodes,w10high2)
w10high2ellen = inner_join(w10highveg2,Ellenbergs)
View(w10high2ellen)
View(w10high2ellen)
?inner_join
diffW10low = left_join(w10lowveg1ellen,w10highveg1ellen)
View(diffW10low)
diffW10high = right_join(w10lowveg1ellen,w10highveg1ellen)
diffW10low = semi_join(w10lowveg1ellen,w10highveg1ellen)
diffW10high = semi_join(w10highveg1ellen,w10lowveg1ellen)
diffW10low = inner_join(w10lowveg1ellen,w10highveg1ellen)
diffW10high = inner_join(w10highveg1ellen,w10lowveg1ellen)
View(w10highveg1ellen)
View(w10highveg1ellen)
View(w10lowveg1ellen)
View(w10lowveg1ellen)
diffW10low = inner_join(w10lowveg1ellen,w10highveg1ellen, by = "Amalgams")
diffW10high = inner_join(w10highveg1ellen,w10lowveg1ellen, by = "Amalgams")
View(diffW10high)
View(diffW10low)
diffW10low = left_join(w10lowveg1ellen,w10highveg1ellen, by = "Amalgams")
diffW10high = inner_join(w10highveg1ellen,w10lowveg1ellen, by = "Amalgams")
View(diffW10low)
diffW10low = na.omit(left_join(w10lowveg1ellen,w10highveg1ellen, by = "Amalgams"))
diffW10high = na.omit(left_join(w10highveg1ellen,w10lowveg1ellen, by = "Amalgams"))
View(diffW10low)
View(diffW10high)
View(w10lowveg1ellen)
diffW10 = setdiff(w10lowveg1ellen,w10highveg1ellen)
View(diffW10)
?setdiff
diffW10 = setdiff(w10lowveg1ellen,w10highveg1ellen,by = "Amalgams")
diffW10high = na.omit(left_join(w10highveg1ellen,w10lowveg1ellen, by = "Amalgams"))
diffW10high = na.omit(left_join(w10lowveg1ellen,w10highveg1ellen, by = "Amalgams"))
diffW10high = na.omit(right_join(w10lowveg1ellen,w10highveg1ellen, by = "Amalgams"))
View(diffW10high)
diffW10high = na.omit(left_join(w10lowveg1ellen,w10highveg1ellen, by = "Amalgams"))
View(diffW10high)
library(dplyr)
diffW10high = na.omit(left_join(w10lowveg1ellen,w10highveg1ellen, by = "Amalgams"))
diffW10high = na.omit(right_join(w10lowveg1ellen,w10highveg1ellen, by = "Amalgams"))
diffW10 = setdiff(w10lowveg1ellen,w10highveg1ellen,by = "Amalgams")
diffW10 = setdiff(w10highveg1ellen,w10lowveg1ellen,by = "Amalgams")
diffW10 = setdiff(w10highveg1ellen,w10lowveg1ellen)
View(diffW10)
diffW10low = setdiff(w10lowveg1ellen$Amalgams,w10highveg1ellen$Amalgams)
vegcodes = read.csv("../Data/vegetation_codes.csv")
colnames(vegcodes) = c("Species","Amalgams")
View(vegcodes)
View(vegcodes)
w10lownothigh = vegcodes%>%filter(Amalgams %in% diffW10low)
View(w10lownothigh)
diffW10high = setdiff(w10highveg1ellen$Amalgams,w10lowveg1ellen$Amalgams)
w10highnotlow = vegcodes%>%filter(Amalgams %in% diffW10low)
View(w10highnotlow)
diffW10high = setdiff(w10highveg1ellen$Amalgams,w10lowveg1ellen$Amalgams)
w10highnotlow = vegcodes%>%filter(Amalgams %in% diffW10high)
View(w10highnotlow)
View(vegcodes)
vegcodes%>%filter(Species == "urtica dioicia")
vegcodes%>%filter(Species == "Urtica dioicia")
View(w10highveg1ellen)
vegcodes%>%filter(Species == "Urtica dioica")
vegcodes%>%filter(Species == "Rhododendron ponticum")
vegcodes%>%filter(Species == "Pteridium aquilinum")
vegcodes%>%filter(Species == "Impatiens glandulifera")
vegcodes%>%filter(Species == "Fallopia japonica
")
vegcodes%>%filter(Species == "Fallopia japonica")
")
